# Epic 3: Intelligent Alert Management Quality Gates Configuration
# This file defines the thresholds and requirements for Epic 3 quality gates

quality_gates:

  # Gate 1: Critical Safety (BLOCKING - Must pass 100%)
  critical_safety:
    blocking: true
    description: "Patient safety requirements that must never be compromised"

    requirements:
      critical_alert_suppression_rate:
        threshold: 0.0
        operator: "equals"
        description: "Critical alerts must NEVER be suppressed"

      red_flag_suppression_rate:
        threshold: 0.0
        operator: "equals"
        description: "Single parameter red flags (score=3) must NEVER be suppressed"

      safety_constraint_violations:
        threshold: 0
        operator: "equals"
        description: "No safety constraint violations allowed"

      critical_alert_delivery_success:
        threshold: 1.0
        operator: "equals"
        description: "100% delivery success for critical alerts required"

      property_test_failures:
        threshold: 0
        operator: "equals"
        description: "All property-based safety tests must pass"

  # Gate 2: ML Model Performance (BLOCKING)
  ml_performance:
    blocking: true
    description: "ML model performance requirements for production deployment"

    requirements:
      suppression_precision:
        threshold: 0.90
        operator: "greater_than_or_equal"
        description: "ML suppression precision must be ≥90%"

      suppression_recall:
        threshold: 0.95
        operator: "greater_than_or_equal"
        description: "ML suppression recall must be ≥95%"

      volume_reduction_achieved:
        threshold: 0.60
        operator: "greater_than_or_equal"
        description: "Must achieve 60% alert volume reduction"

      clinical_interpretability_score:
        threshold: 0.85
        operator: "greater_than_or_equal"
        description: "ML decisions must be clinically interpretable"

      demographic_bias_detected:
        threshold: false
        operator: "equals"
        description: "No demographic bias allowed in ML decisions"

      model_confidence_threshold:
        threshold: 0.80
        operator: "greater_than_or_equal"
        description: "Model confidence must be ≥80% for suppression decisions"

  # Gate 3: Communication Reliability (BLOCKING)
  communication_reliability:
    blocking: true
    description: "Multi-channel communication reliability requirements"

    requirements:
      critical_alert_delivery_sla:
        threshold: 15.0
        operator: "less_than"
        unit: "seconds"
        description: "Critical alerts must be delivered within 15 seconds"

      delivery_success_rate:
        threshold: 0.999
        operator: "greater_than_or_equal"
        description: "99.9% delivery success rate required"

      failover_activation_time:
        threshold: 30.0
        operator: "less_than"
        unit: "seconds"
        description: "Failover must activate within 30 seconds"

      network_partition_recovery:
        threshold: 60.0
        operator: "less_than"
        unit: "seconds"
        description: "Network partition recovery within 60 seconds"

      channel_failure_detection:
        threshold: 30.0
        operator: "less_than"
        unit: "seconds"
        description: "Channel failures must be detected within 30 seconds"

      message_queue_persistence:
        threshold: 1.0
        operator: "equals"
        description: "100% message persistence during failures"

  # Gate 4: Clinical Workflow Integration (WARNING)
  clinical_integration:
    blocking: false
    warning_threshold: 0.8
    description: "Clinical workflow integration requirements"

    requirements:
      end_to_end_scenario_success:
        threshold: 0.95
        operator: "greater_than_or_equal"
        description: "95% success rate for end-to-end clinical scenarios"

      escalation_timeline_accuracy:
        threshold: 1.0
        operator: "equals"
        description: "100% accuracy in escalation timing"

      shift_handoff_continuity:
        threshold: 1.0
        operator: "equals"
        description: "100% alert continuity during shift handoffs"

      multi_ward_coordination:
        threshold: 0.95
        operator: "greater_than_or_equal"
        description: "95% success in multi-ward rapid response coordination"

      clinical_decision_support:
        threshold: 0.90
        operator: "greater_than_or_equal"
        description: "90% effectiveness of clinical decision support"

  # Gate 5: Performance Requirements (WARNING)
  performance:
    blocking: false
    warning_threshold: 0.85
    description: "System performance and scalability requirements"

    requirements:
      ml_inference_latency:
        threshold: 10.0
        operator: "less_than"
        unit: "milliseconds"
        description: "ML inference must complete within 10ms"

      concurrent_alert_processing:
        threshold: 100.0
        operator: "greater_than_or_equal"
        unit: "alerts_per_second"
        description: "Must process 100+ alerts per second"

      memory_usage_limit:
        threshold: 2.0
        operator: "less_than"
        unit: "gigabytes"
        description: "Memory usage must stay under 2GB"

      database_query_latency:
        threshold: 100.0
        operator: "less_than"
        unit: "milliseconds"
        description: "Database queries must complete within 100ms"

      cache_hit_ratio:
        threshold: 0.90
        operator: "greater_than_or_equal"
        description: "Cache hit ratio must be ≥90%"

  # Gate 6: Security and Compliance (WARNING)
  security:
    blocking: false
    warning_threshold: 0.9
    description: "Security and regulatory compliance requirements"

    requirements:
      input_validation_coverage:
        threshold: 1.0
        operator: "equals"
        description: "100% input validation coverage required"

      authentication_edge_cases:
        threshold: 1.0
        operator: "equals"
        description: "100% coverage of authentication edge cases"

      audit_trail_completeness:
        threshold: 1.0
        operator: "equals"
        description: "100% audit trail completeness for all operations"

      phi_protection_validation:
        threshold: 1.0
        operator: "equals"
        description: "100% PHI protection validation"

      security_scan_high_severity:
        threshold: 0
        operator: "equals"
        description: "No high severity security vulnerabilities allowed"

# Test execution configuration
test_execution:

  # Property-based testing configuration
  property_testing:
    max_examples: 10000
    deadline_ms: 30000
    database_examples: true

  # Load testing configuration
  load_testing:
    concurrent_users: 100
    ramp_up_rate: 10
    test_duration_seconds: 300
    target_throughput: 100

  # Chaos engineering configuration
  chaos_testing:
    network_partition_duration: 60
    service_failure_duration: 30
    memory_pressure_percentage: 80

# Reporting configuration
reporting:

  # Quality metrics to track
  metrics:
    - patient_safety_score
    - ml_model_performance
    - communication_reliability
    - clinical_workflow_effectiveness
    - system_performance
    - security_compliance_score

  # Notification thresholds
  notifications:
    critical_failure:
      channels: ["slack", "email", "pagerduty"]
      conditions: ["blocking_gate_failure", "safety_violation"]

    warning:
      channels: ["slack", "email"]
      conditions: ["warning_gate_failure", "performance_degradation"]

    success:
      channels: ["slack"]
      conditions: ["all_gates_passed", "production_ready"]

# Environment-specific overrides
environments:

  development:
    # Relaxed thresholds for development
    overrides:
      ml_performance.suppression_precision.threshold: 0.85
      performance.ml_inference_latency.threshold: 20.0

  staging:
    # Production-like thresholds for staging
    overrides:
      critical_safety.critical_alert_suppression_rate.threshold: 0.0
      communication_reliability.delivery_success_rate.threshold: 0.995

  production:
    # Strictest thresholds for production
    overrides:
      critical_safety.critical_alert_suppression_rate.threshold: 0.0
      ml_performance.suppression_precision.threshold: 0.95
      communication_reliability.delivery_success_rate.threshold: 0.999